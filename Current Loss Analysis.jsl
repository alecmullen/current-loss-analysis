Names Default To Here(1);::this_dir = Get Current Directory();cla = Run Program( Executable( "/Users/alecmullen/anaconda3/bin/python3" ), Options({::this_dir||"current-loss-analysis.py" }));List to String = Function({l},	s = "["||Concat Items(l, ", ")||"]";);cla << Read();::dt = :DateTime << Get Values(Format ("Locale Date Time h:m:s"));cla << Write("['"||Concat Items(::dt, "', '")||"']"||"\!n");cla << Read();::wl = :WL << Get Values(Format (Best));cla << Write(List to String(::wl)||"\!n");cla << Read();::qe = :QE << Get Values(Format (Best));cla << Write(List to String(::qe)||"\!n");cla << Read();::bg = :Bandgap << Get Values(Format (Best));cla << Write(List to String(::bg)||"\!n");cla << Read();cla << Write("Users/alecmullen/current-loss-analysis/AM1.5G.xlsx"||"\!n");cla << Read();testDialog = Dialog(       Title( "Current Loss Analysis" ),       Vlist(              " ",              Hlist(                     Vlist( Hlist( "                                " ) ),                     Vlist(                           HList( "Please Enter QE Test DateTime" ),                           HList(" "),                           HList(                                  VList( "Time Entry:", " "  ),                                  VList(                                         StartTimeEntry = EditText( Format( today(), "m/d/y h:m:s" ) ),                                         " ",                                   ),                            ),                      ),               ),                           VList( " " ),                                 Hlist( Button( "OK" ), Button( "Cancel" ) )       )); If( testDialog["Button"] == -1,       Throw( "Canceled" )); Remove From( testDialog );Eval List( testDialog );cla << Write(StartTimeEntry||"\!n");::out = cla << Read();::out = Substr(::out, Contains(::out, "["));::wl_data_string = "";While(!Contains(::out, "Best Fits"),	Wait(0);	::wl_data_string = ::wl_data_string||::out;	::out = cla << Read(););::wl_data_string = ::wl_data_string||Substr(::out, 0, Contains(::out, "]"));::out = Substr(::out, Contains(::out, "["));::bf_data_string = "";While(!Contains(::out, "Convolution"),	Wait(0);	::bf_data_string = ::bf_data_string||::out;	::out = cla << Read(););::bf_data_string = ::bf_data_string||Substr(::out, 0, Contains(::out, "]"));::out = Substr(::out, Contains(::out, "["));::conv_data_string = "";While(!Contains(::out, "AM15G"),	Wait(0);	::conv_data_string = ::conv_data_string||::out;	::out = cla << Read(););::conv_data_string = ::conv_data_string||Substr(::out, 0, Contains(::out, "]"));::out = Substr(::out, Contains(::out, "["));::am_data_string = "";While(!Contains(::out, "Current Loss"),	Wait(0);	::am_data_string = ::am_data_string||::out;	::out = cla << Read(););::am_data_string = ::am_data_string||Substr(::out, 0, Contains(::out, "]"));::current_loss_string = Substr(::out, Contains(::out, "Current Loss"));String to List = Function({s},	l = {};	s = Substr(s, Contains(s, "[") + 1);	While (Contains(s, ","),		Wait(0);		Insert Into(l, Num(Substr(s, 0, Contains(s, ",") - 1)));		s = Substr(s, Contains(s, " ") + 1);	);	Insert Into(l, Num(Substr(s, 0, Contains(s, "]") - 1)));	l;);::wl_data = String to List(::wl_data_string);::bf_data = String to List(::bf_data_string);::conv_data = String to List(::conv_data_string);::am_data = String to List(::am_data_string);dt1 = current data table();dt2 = new table();dt2 << Set Name("Best Fit");dt2 << new column("WL", numeric); column(dt2,1) << set values(wl_data); dt2 << new column("Best Fit QE", numeric); column(dt2,2) << set values(bf_data);dt2 << new column("Electrons/(s*m^2)", numeric);column(dt2,3) << set values(conv_data);dt2 << new column("AM15G Photons/(s*m^2)", numeric);column(dt2,4) << set values(am_data);dt3 = dt2 << Join(	With(dt1),	By Matching Columns( :WL = :WL ),    Drop multiples( 0, 0 ),    Include nonmatches(1, 0),	Preserve main table order( 1 ));close(dt2);For Each Row( Row State() = Selected State(!isMissing(:DateTime) & :DateTime != Num(StartTimeEntry)) );dt3 << delete rows();dt3 << delete column(:DateTime);dt3 << new column("Total Current Density Loss A/m^2", numeric);::cl = Substr(::current_loss_string, Contains(::current_loss_string, ": ") + 2);::cl = Substr(::cl, 0, Contains(::cl, " ") - 1);::current_loss = Num(::cl);::cl_list = {};For Each Row(dt3, Insert Into(::cl_list, ::current_loss));Column(dt3, "Total Current Density Loss A/m^2") << Set Values(::cl_list);dt3 << Set Name(StartTimeEntry||" Current Loss Analysis");dialog(Title("Current Loss Added to Table"), ::current_loss_string);